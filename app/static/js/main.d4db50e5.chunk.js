(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{198:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(0),c=a.n(r),i=a(17),s=a.n(i),o=a(86),l=a(151),j=a(233),d=a(104),u=a.n(d),b=a(105),p=a.n(b),O=a(234),m=Object(l.a)({palette:{primary:{light:u.a[500],main:u.a[700],dark:u.a[900]},secondary:{light:p.a[200],main:p.a[500],dark:p.a[700]}},typography:{useNextVariants:!0}}),g=e=>t=>Object(n.jsxs)(j.a,{theme:m,children:[Object(n.jsx)(O.a,{}),Object(n.jsx)(e,Object(o.a)({},t))]}),h=a(63),x=a(21),f=a(11),v=a(10),k=a(242),y=a(22),w=a(31),S=a.n(w),N=a(48),I=a(154),C=a(200),T=a(264),q=a(96),$=a.n(q),L=a(141),W=a.n(L);function F(){var e=Object(y.a)(["\n  query($search: String) {\n    tracks(search: $search) {\n      id\n      title\n      description\n      url\n      likes {\n        id\n      }\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"]);return F=function(){return e},e}var A=Object(f.gql)(F()),B=Object(k.a)((e=>({root:{padding:"2px 4px",margin:e.spacing.unit,display:"flex",alignItems:"center"}}))),R=({setSearchResults:e})=>{var t=B(),a=Object(r.useRef)(null),c=Object(r.useState)(""),i=Object(v.a)(c,2),s=i[0],o=i[1],l=function(){var t=Object(N.a)(S.a.mark((function t(a,n){var r;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,n.query({query:A,variables:{search:s}});case 3:r=t.sent,e(r.data.tracks);case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),j=()=>{e([]),o(""),a.current.focus()};return Object(n.jsx)(f.ApolloConsumer,{children:e=>Object(n.jsx)("form",{onSubmit:t=>l(t,e),children:Object(n.jsxs)(I.a,{className:t.root,elevation:1,children:[Object(n.jsx)(C.a,{onClick:j,children:Object(n.jsx)($.a,{})}),Object(n.jsx)(T.a,{fullWidth:!0,placeholder:"Search All Tracks",InputProps:{disableUnderline:!0},onChange:e=>o(e.target.value),value:s,inputRef:a}),Object(n.jsx)(C.a,{type:"submit",children:Object(n.jsx)(W.a,{})})]})})})},D=a(240),U=a(268),z=a(249),Q=a(250),P=a(251),E=a(252),M=a(50),J=a(253),G=a(145),V=a.n(G),H=a(142),K=a.n(H),X=({url:e})=>Object(n.jsx)("div",{children:Object(n.jsx)(K.a,{url:e,height:"30px",width:"500px",controls:!0})}),Y=a(101),Z=a.n(Y),_=a(266),ee=a(243),te=Object(k.a)((e=>({snackbar:{margin:e.spacing.unit}}))),ae=({error:e})=>{var t=Object(r.useState)(!0),a=Object(v.a)(t,2),c=a[0],i=a[1],s=te();return Object(n.jsx)(_.a,{open:c,className:s.snackbar,action:Object(n.jsx)(ee.a,{onClick:()=>{i(!1)},color:"secondary",size:"small",children:"Close"}),message:e})};function ne(){var e=Object(y.a)(["\n  {\n    me {\n      id\n      username\n      email\n      likeSet {\n        track {\n          id\n        }\n      }\n    }\n  }\n"]);return ne=function(){return e},e}function re(){var e=Object(y.a)(["\n  query getTracksQuery {\n    tracks {\n      id\n      title\n      description\n      url\n      likes {\n        id\n      }\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"]);return re=function(){return e},e}function ce(){var e=Object(y.a)(["\n  query IsUserLoggedIn {\n    isLoggedIn @client\n  }\n"]);return ce=function(){return e},e}var ie=Object(f.gql)(ce()),se=Object(f.gql)(re()),oe=Object(f.gql)(ne());function le(){var e=Object(y.a)(["\n  mutation($trackId: Int!) {\n    createLike(trackId: $trackId) {\n      track {\n        id\n        likes {\n          id\n        }\n      }\n    }\n  }\n"]);return le=function(){return e},e}var je=Object(f.gql)(le()),de=Object(k.a)((e=>({iconButton:{color:"deeppink"},icon:{marginLeft:e.spacing.unit/2}}))),ue=({trackId:e,likeCount:t})=>{var a=de(),c=Object(r.useContext)(pt),i=Object(f.useMutation)(je,{refetchQueries:[{query:oe}]}),s=Object(v.a)(i,2),o=s[0],l=s[1].error;if(l)return Object(n.jsx)(ae,{error:l});return Object(n.jsxs)(C.a,{onClick:t=>{t.stopPropagation(),o({variables:{trackId:e}})},className:a.iconButton,disabled:c.likeSet.findIndex((({track:t})=>t.id===e))>-1,children:[t,Object(n.jsx)(Z.a,{className:a.icon})]})},be=a(244),pe=a(143),Oe=a.n(pe);function me(){var e=Object(y.a)(["\n  mutation($trackId: Int!) {\n    deleteTrack(trackId: $trackId) {\n      trackId\n    }\n  }\n"]);return me=function(){return e},e}var ge=Object(f.gql)(me()),he=({track:e})=>{var t=Object(r.useContext)(pt),a=Object(r.useState)(!1),c=Object(v.a)(a,2),i=c[0],s=c[1],o=Object(f.useMutation)(ge,{update(e,t){u(e,t)},onCompleted(){b()}}),l=Object(v.a)(o,2),j=l[0],d=l[1].error,u=(e,{data:{deleteTrack:t}})=>{var a=e.readQuery({query:se}),n=a.tracks.findIndex((e=>Number(e.id)===t.trackId)),r=[...a.tracks.slice(0,n),...a.tracks.slice(n+1)];e.writeQuery({query:se,data:{tracks:r}})},b=()=>{s(!1)},p=t.id===e.postedBy.id;return d?Object(n.jsx)(ae,{error:"Delete Track Error"}):p&&Object(n.jsx)(C.a,{onClick:()=>{s(!0),j({variables:{trackId:e.id}})},children:i?Object(n.jsx)(be.a,{size:24}):Object(n.jsx)(Oe.a,{})})},xe=a(267),fe=a(245),ve=a(246),ke=a(247),ye=a(238),we=a(241),Se=a(248),Ne=a(144),Ie=a.n(Ne),Ce=a(102),Te=a.n(Ce);function qe(){var e=Object(y.a)(["\n  mutation(\n    $trackId: Int!\n    $title: String!\n    $description: String!\n    $file: Upload!\n  ) {\n    updateTrack(\n      trackId: $trackId\n      title: $title\n      description: $description\n      file: $file\n    ) {\n      track {\n        id\n        title\n        description\n        url\n        likes {\n          id\n        }\n        postedBy {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return qe=function(){return e},e}var $e=Object(f.gql)(qe()),Le=Object(k.a)((e=>({container:{display:"flex",flexWrap:"wrap"},dialog:{margin:"0 auto",maxWidth:550},textField:{margin:e.spacing.unit},cancel:{color:"red"},save:{color:"green"},button:{margin:2*e.spacing.unit},icon:{marginLeft:e.spacing.unit},input:{display:"none"}}))),We=({track:e})=>{var t=Le(),a=Object(r.useContext)(pt),c=Object(f.useMutation)($e,{onCompleted(){z()}}),i=Object(v.a)(c,2),s=i[0],o=i[1].error,l=Object(r.useState)(!1),j=Object(v.a)(l,2),d=j[0],u=j[1],b=Object(r.useState)(e.title),p=Object(v.a)(b,2),O=p[0],m=p[1],g=Object(r.useState)(e.description),h=Object(v.a)(g,2),x=h[0],k=h[1],y=Object(r.useState)(""),w=Object(v.a)(y,2),I=w[0],q=w[1],$=Object(r.useState)(!1),L=Object(v.a)($,2),W=L[0],F=L[1],A=Object(r.useState)(""),B=Object(v.a)(A,2),R=B[0],D=B[1],U=a.id===e.postedBy.id,z=()=>{u(!1),F(!1),m(""),k(""),q("")},Q=function(){var t=Object(N.a)(S.a.mark((function t(a){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),F(!0),s({variables:{title:O,description:x,file:I,trackId:e.id}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return o?Object(n.jsx)(ae,{error:"Update Track Error"}):U&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(C.a,{onClick:()=>{u(!0)},children:Object(n.jsx)(Ie.a,{})}),Object(n.jsx)(xe.a,{open:d,className:t.dialog,children:Object(n.jsxs)("form",{onSubmit:e=>{Q(e)},children:[Object(n.jsx)(fe.a,{children:"Update Track"}),Object(n.jsx)(ve.a,{children:Object(n.jsxs)(ke.a,{component:"span",children:["Update Title, Description or Audio File",Object(n.jsx)(ye.a,{fullWidth:!0,children:Object(n.jsx)(T.a,{label:"Title",placeholder:"Add Title",className:t.textField,onChange:e=>{m(e.target.value)},value:O})}),Object(n.jsx)(ye.a,{fullWidth:!0,children:Object(n.jsx)(T.a,{multiline:!0,row:"2",label:"Description",placeholder:"Add Description",className:t.textField,onChange:e=>{k(e.target.value)},value:x})}),Object(n.jsxs)(ye.a,{fullWidth:!0,error:""!==R,children:[Object(n.jsx)("input",{id:"audio",required:!0,type:"file",className:t.input,accept:"audio/mp3,audio/wav",onChange:e=>{var t=e.target.files[0];t&&t.size>1e7?D("".concat(t.name,": File size too large, 10mb max.")):(q(t),D(""))}}),Object(n.jsxs)("label",{htmlFor:"audio",children:[Object(n.jsxs)(ee.a,{variant:"outlined",color:I?"secondary":"inherit",component:"span",className:t.button,children:["Audio File",Object(n.jsx)(Te.a,{className:t.icon})]}),I&&I.name]}),Object(n.jsx)(we.a,{children:R})]})]})}),Object(n.jsxs)(Se.a,{children:[Object(n.jsx)(ee.a,{onClick:()=>{u(!1)},className:t.cancel,disabled:W,children:"Cancel"}),Object(n.jsx)(ee.a,{disabled:W||!O.trim()||!x.trim()||!I,type:"submit",className:t.save,children:W?Object(n.jsx)(be.a,{size:24,className:t.save}):"Update Track"})]})]})})]})},Fe=Object(k.a)((e=>({root:{display:"flex",flexWrap:"wrap"},details:{alignItems:"center"},link:{color:"#424242",textDecoration:"none","&:hover":{color:"black"}}}))),Ae=({tracks:e})=>{var t=Fe();return Object(n.jsx)(D.a,{children:e.map((e=>Object(n.jsxs)(U.a,{children:[Object(n.jsx)(z.a,{expandIcon:Object(n.jsx)(V.a,{}),children:Object(n.jsxs)(Q.a,{className:t.root,children:[Object(n.jsx)(ue,{trackId:e.id,likeCount:e.likes.length}),Object(n.jsx)(P.a,{primaryTypographyProps:{variant:"h4",color:"primary"},primary:e.title,secondary:Object(n.jsx)(h.b,{to:"/profile/".concat(e.postedBy.id),className:t.link,children:e.postedBy.username})}),Object(n.jsx)(X,{url:e.url})]})}),Object(n.jsx)(E.a,{className:t.details,children:Object(n.jsx)(M.a,{variant:"body1",children:e.description})}),Object(n.jsxs)(J.a,{children:[Object(n.jsx)(We,{track:e}),Object(n.jsx)(he,{track:e})]})]},e.id)))})},Be=a(146),Re=a.n(Be);function De(){var e=Object(y.a)(["\n  mutation($title: String!, $description: String!, $file: Upload!) {\n    createTrack(title: $title, description: $description, file: $file) {\n      track {\n        id\n        title\n        description\n        url\n        likes {\n          id\n        }\n        postedBy {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return De=function(){return e},e}var Ue=Object(f.gql)(De()),ze=Object(k.a)((e=>({container:{display:"flex",flexWrap:"wrap"},dialog:{margin:"0 auto",maxWidth:550},textField:{margin:e.spacing.unit},cancel:{color:"red"},save:{color:"green"},button:{margin:2*e.spacing.unit},icon:{marginLeft:e.spacing.unit},input:{display:"none"},fab:{position:"fixed",bottom:2*e.spacing.unit,right:2*e.spacing.unit,zIndex:"200"}}))),Qe=()=>{var e=ze(),t=Object(f.useMutation)(Ue,{update(e,t){A(e,t)},onCompleted(){B()}}),a=Object(v.a)(t,2),c=a[0],i=a[1].error,s=Object(r.useState)(!1),o=Object(v.a)(s,2),l=o[0],j=o[1],d=Object(r.useState)(""),u=Object(v.a)(d,2),b=u[0],p=u[1],O=Object(r.useState)(""),m=Object(v.a)(O,2),g=m[0],h=m[1],x=Object(r.useState)(""),k=Object(v.a)(x,2),y=k[0],w=k[1],S=Object(r.useState)(!1),N=Object(v.a)(S,2),I=N[0],C=N[1],q=Object(r.useState)(""),L=Object(v.a)(q,2),W=L[0],F=L[1],A=(e,{data:{createTrack:t}})=>{var a=e.readQuery({query:se}).tracks.concat(t.track);e.writeQuery({query:se,data:{tracks:a}})},B=()=>{j(!1),C(!1),p(""),h(""),w("")};return i?Object(n.jsx)(ae,{error:"Create Track Error"}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(ee.a,{onClick:()=>{j(!0)},variant:"outlined",className:e.fab,color:"secondary",children:l?Object(n.jsx)($.a,{}):Object(n.jsx)(Re.a,{})}),Object(n.jsx)(xe.a,{open:l,className:e.dialog,children:Object(n.jsxs)("form",{onSubmit:e=>{(e=>{e.preventDefault(),C(!0),c({variables:{title:b,description:g,file:y}})})(e)},children:[Object(n.jsx)(fe.a,{children:"Create Track"}),Object(n.jsx)(ve.a,{children:Object(n.jsxs)(ke.a,{component:"span",children:["Add a Title, Description and Audio File",Object(n.jsx)(ye.a,{fullWidth:!0,children:Object(n.jsx)(T.a,{label:"Title",placeholder:"Add Title",className:e.textField,onChange:e=>{p(e.target.value)},value:b})}),Object(n.jsx)(ye.a,{fullWidth:!0,children:Object(n.jsx)(T.a,{multiline:!0,row:"2",label:"Description",placeholder:"Add Description",className:e.textField,onChange:e=>{h(e.target.value)},value:g})}),Object(n.jsxs)(ye.a,{fullWidth:!0,error:""!==W,children:[Object(n.jsx)("input",{id:"audio",required:!0,type:"file",className:e.input,accept:"audio/mp3,audio/wav",onChange:e=>{var t=e.target.files[0];t&&t.size>1e7?F("".concat(t.name,": File size too large, 10mb max.")):(w(t),F(""))}}),Object(n.jsxs)("label",{htmlFor:"audio",children:[Object(n.jsxs)(ee.a,{variant:"outlined",color:y?"secondary":"inherit",component:"span",className:e.button,children:["Audio File",Object(n.jsx)(Te.a,{className:e.icon})]}),y&&y.name]}),Object(n.jsx)(we.a,{children:W})]})]})}),Object(n.jsxs)(Se.a,{children:[Object(n.jsx)(ee.a,{onClick:()=>{j(!1)},className:e.cancel,disabled:I,children:"Cancel"}),Object(n.jsx)(ee.a,{disabled:I||!b.trim()||!g.trim()||!y,type:"submit",className:e.save,children:I?Object(n.jsx)(be.a,{size:24,className:e.save}):"Add Track"})]})]})})]})},Pe=Object(k.a)((e=>({root:{width:"100vw",textAlign:"center"},progress:{margin:2*e.spacing.unit,color:e.palette.secondary.dark}}))),Ee=()=>{var e=Pe();return Object(n.jsx)("div",{className:e.root,children:Object(n.jsx)(be.a,{className:e.progress})})},Me=Object(k.a)((e=>({container:{margin:"0 auto",maxWidth:960,padding:2*e.spacing.unit}}))),Je=()=>{var e=Me(),t=Object(r.useState)([]),a=Object(v.a)(t,2),c=a[0],i=a[1],s=Object(r.useState)([]),o=Object(v.a)(s,2),l=o[0],j=o[1],d=Object(f.useQuery)(se),u=d.loading,b=d.error,p=d.data;return Object(r.useEffect)((()=>{c.length>0?j(c):p&&j(p.tracks)}),[c,p]),u?Object(n.jsx)(Ee,{}):b?Object(n.jsx)(ae,{error:b}):Object(n.jsxs)("div",{className:e.container,children:[Object(n.jsx)(R,{setSearchResults:i}),Object(n.jsx)(Qe,{}),Object(n.jsx)(Ae,{tracks:l})]})},Ge=a(254),Ve=a(255),He=a(270),Ke=a(256),Xe=a(147),Ye=a.n(Xe);function Ze(){var e=Object(y.a)(["\n  query($id: Int!) {\n    user(id: $id) {\n      id\n      username\n      dateJoined\n      trackSet {\n        id\n        title\n        url\n        likes {\n          id\n        }\n      }\n      likeSet {\n        id\n        track {\n          id\n          title\n          url\n          likes {\n            id\n          }\n          postedBy {\n            id\n            username\n          }\n        }\n      }\n    }\n  }\n"]);return Ze=function(){return e},e}var _e=Object(f.gql)(Ze()),et=Object(k.a)((e=>({paper:{width:"auto",display:"block",padding:2*e.spacing.unit,marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit,[e.breakpoints.up("md")]:{width:650,marginLeft:"auto",marginRight:"auto"}},card:{display:"flex",justifyContent:"center"},title:{display:"flex",alignItems:"center",marginBottom:2*e.spacing.unit},audioIcon:{color:"purple",fontSize:30,marginRight:e.spacing.unit},thumbIcon:{color:"green",marginRight:e.spacing.unit},divider:{marginTop:e.spacing.unit,marginBottom:e.spacing.unit}}))),tt=({match:e})=>{var t=et(),a=Object(f.useQuery)(_e,{variables:{id:e.params.id}}),r=a.loading,c=a.error,i=a.data;return r?Object(n.jsx)(Ee,{}):c?Object(n.jsx)(ae,{error:c}):Object(n.jsxs)("div",{children:[Object(n.jsx)(Ge.a,{className:t.card,children:Object(n.jsx)(Ve.a,{avatar:Object(n.jsx)(He.a,{children:i.user.username[0]}),title:i.user.username,subheader:"Joined ".concat(new Date(i.user.dateJoined).toISOString().substring(0,10))})}),Object(n.jsxs)(I.a,{elevation:1,className:t.paper,children:[Object(n.jsxs)(M.a,{variant:"subtitle1",className:t.title,children:[Object(n.jsx)(Ye.a,{className:t.audioIcon}),"Created Tracks"]}),i.user.trackSet.map((e=>Object(n.jsxs)("div",{children:[Object(n.jsxs)(M.a,{children:[e.title," - ",e.likes.length," Likes"]}),Object(n.jsx)(X,{url:e.url}),Object(n.jsx)(Ke.a,{className:t.divider})]},e.id)))]}),Object(n.jsxs)(I.a,{elevation:1,className:t.paper,children:[Object(n.jsxs)(M.a,{variant:"subtitle1",className:t.title,children:[Object(n.jsx)(Z.a,{className:t.thumbIcon}),"Liked Tracks"]}),i.user.likeSet.map((({track:e})=>Object(n.jsxs)("div",{children:[Object(n.jsxs)(M.a,{children:[e.title," - ",e.likes.length," Likes -"," ",e.postedBy.username]}),Object(n.jsx)(X,{url:e.url}),Object(n.jsx)(Ke.a,{className:t.divider})]},e.id)))]})]})},at=a(257),nt=a(258),rt=a(149),ct=a.n(rt),it=a(150),st=a.n(it),ot=a(148),lt=a.n(ot),jt=Object(k.a)((e=>({root:{cursor:"pointer",display:"flex"},buttonIcon:{marginLeft:"5px"}}))),dt=()=>{var e=jt(),t=function(){var e=Object(N.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("authToken"),t.writeQuery({query:ie,data:{isLoggedIn:!1}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(f.ApolloConsumer,{children:a=>Object(n.jsxs)(ee.a,{onClick:()=>{t(a)},children:[Object(n.jsx)(M.a,{variant:"body1",className:e.buttonIcon,color:"secondary",children:"Signout"}),Object(n.jsx)(lt.a,{className:e.buttonIcon,color:"secondary"})]})})},ut=Object(k.a)((e=>({root:{flexGrow:1,margin:0,padding:0},grow:{flexGrow:1,display:"flex",alignItems:"center",textDecoration:"none"},logo:{marginRight:e.spacing.unit,fontSize:45},faceIcon:{marginRight:e.spacing.unit,fontSize:30,color:"white"},username:{color:"white",fontSize:30}}))),bt=({currentUser:e})=>{var t=ut();return Object(n.jsx)(at.a,{position:"static",className:t.root,children:Object(n.jsxs)(nt.a,{children:[Object(n.jsxs)(h.b,{to:"/",className:t.grow,children:[Object(n.jsx)(ct.a,{className:t.logo,color:"secondary"}),Object(n.jsx)(M.a,{variant:"h3",color:"secondary",noWrap:!0,children:"Musicallen"})]}),e&&Object(n.jsxs)(h.b,{to:"/profile/".concat(e.id),className:t.grow,children:[Object(n.jsx)(st.a,{className:t.faceIcon}),Object(n.jsx)(M.a,{variant:"h3",className:t.username,noWrap:!0,children:e.username})]}),Object(n.jsx)(dt,{})]})})},pt=c.a.createContext(),Ot=g((()=>{var e=Object(f.useQuery)(oe,{fetchPolicy:"cache-and-network"}),t=e.loading,a=e.error,r=e.data;return t?Object(n.jsx)(Ee,{}):a?Object(n.jsx)(ae,{error:a}):Object(n.jsx)(h.a,{children:Object(n.jsxs)(pt.Provider,{value:r.me,children:[Object(n.jsx)(bt,{currentUser:r.me}),Object(n.jsxs)(x.c,{children:[Object(n.jsx)(x.a,{path:"/",exact:!0,component:Je}),Object(n.jsx)(x.a,{path:"/profile/:id",component:tt})]})]})})})),mt=a(269),gt=a(237),ht=a(259);function xt(){var e=Object(y.a)(["\n  mutation($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return xt=function(){return e},e}var ft=Object(f.gql)(xt()),vt=Object(k.a)((e=>({root:{width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,[e.breakpoints.up("md")]:{width:400,marginLeft:"auto",marginRight:"auto"}},paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit},title:{marginTop:2*e.spacing.unit,color:e.palette.secondary.main},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.primary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit}}))),kt=({setIsLogin:e})=>{var t=Object(r.useState)(""),a=Object(v.a)(t,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(v.a)(s,2),l=o[0],j=o[1],d=vt(),u=Object(f.useMutation)(ft),b=Object(v.a)(u,2),p=b[0],O=b[1],m=O.loading,g=O.error,h=O.client,x=function(){var e=Object(N.a)(S.a.mark((function e(t){var a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,p({variables:{password:l,username:c}});case 4:a=e.sent,localStorage.setItem("authToken",a.data.tokenAuth.token),h.writeQuery({query:ie,data:{isLoggedIn:!0}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{className:d.root,children:Object(n.jsxs)(I.a,{className:d.paper,children:[Object(n.jsx)(He.a,{className:d.avatar,children:Object(n.jsx)(ht.a,{})}),Object(n.jsx)(M.a,{variant:"h4",children:"Login as Existing User"}),Object(n.jsxs)("form",{className:d.form,onSubmit:e=>{x(e)},children:[Object(n.jsxs)(ye.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(n.jsx)(mt.a,{htmlFor:"username",children:"Username"}),Object(n.jsx)(gt.a,{id:"username",onChange:e=>{i(e.target.value)}})]}),Object(n.jsxs)(ye.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(n.jsx)(mt.a,{htmlFor:"password",children:"Password"}),Object(n.jsx)(gt.a,{id:"password",type:"password",onChange:e=>{j(e.target.value)}})]}),Object(n.jsx)(ee.a,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",disabled:m||!c.trim()||!l.trim(),className:d.submit,children:m?"Logging in...":"Login"}),Object(n.jsx)(ee.a,{onClick:()=>{e(!1)},color:"primary",variant:"outlined",fullWidth:!0,children:"New user? Register here."}),m&&Object(n.jsx)("p",{children:"Loading..."}),g&&Object(n.jsx)(ae,{error:g.toString()})]})]})})},yt=a(260),wt=a(261),St=a(262);function Nt(){var e=Object(y.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    createUser(username: $username, email: $email, password: $password) {\n      user {\n        username\n        email\n      }\n    }\n  }\n"]);return Nt=function(){return e},e}var It=c.a.forwardRef(((e,t)=>Object(n.jsx)(yt.a,Object(o.a)({direction:"up",ref:t},e)))),Ct=Object(f.gql)(Nt()),Tt=Object(k.a)((e=>({root:{width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,[e.breakpoints.up("md")]:{width:400,marginLeft:"auto",marginRight:"auto"}},paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit},title:{marginTop:2*e.spacing.unit,color:e.palette.openTitle},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},icon:{padding:"0px 2px 2px 0px",verticalAlign:"middle",color:"green"}}))),qt=({setIsLogin:e})=>{var t=Object(r.useState)(""),a=Object(v.a)(t,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(v.a)(s,2),l=o[0],j=o[1],d=Object(r.useState)(""),u=Object(v.a)(d,2),b=u[0],p=u[1],O=Object(r.useState)(!1),m=Object(v.a)(O,2),g=m[0],h=m[1],x=Tt(),k=Object(f.useMutation)(Ct),y=Object(v.a)(k,2),w=y[0],C=y[1],T=C.loading,q=C.error,$=function(){var e=Object(N.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,w({variables:{email:l,password:b,username:c}});case 4:h(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:x.root,children:[Object(n.jsxs)(I.a,{className:x.paper,children:[Object(n.jsx)(He.a,{className:x.avatar,children:Object(n.jsx)(wt.a,{})}),Object(n.jsx)(M.a,{variant:"h4",children:"Register"}),Object(n.jsxs)("form",{className:x.form,onSubmit:e=>{$(e)},children:[Object(n.jsxs)(ye.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(n.jsx)(mt.a,{htmlFor:"username",children:"Username"}),Object(n.jsx)(gt.a,{id:"username",onChange:e=>{i(e.target.value)}})]}),Object(n.jsxs)(ye.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(n.jsx)(mt.a,{htmlFor:"email",children:"Email"}),Object(n.jsx)(gt.a,{id:"email",type:"email",onChange:e=>{j(e.target.value)}})]}),Object(n.jsxs)(ye.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(n.jsx)(mt.a,{htmlFor:"password",children:"Password"}),Object(n.jsx)(gt.a,{id:"password",type:"password",onChange:e=>{p(e.target.value)}})]}),Object(n.jsx)(ee.a,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",disabled:T||!c.trim()||!l.trim()||!b.trim(),className:x.submit,children:T?"Registering...":"Register"}),Object(n.jsx)(ee.a,{onClick:()=>{e(!0)},color:"primary",variant:"outlined",fullWidth:!0,children:"Previous user? Login in here."}),T&&Object(n.jsx)("p",{children:"Loading..."}),q&&Object(n.jsx)(ae,{error:q.toString()})]})]}),Object(n.jsxs)(xe.a,{disableBackdropClick:!0,open:g,TransitionComponent:It,children:[Object(n.jsxs)(fe.a,{children:[Object(n.jsx)(St.a,{className:x.icon}),"New Account"]}),Object(n.jsxs)(ve.a,{children:[Object(n.jsxs)(ke.a,{children:["User ",c," successfully created!"]}),Object(n.jsxs)(Se.a,{children:[Object(n.jsx)(ee.a,{color:"primary",variant:"contained",onClick:()=>{e(!0)},children:"Login"}),q&&Object(n.jsx)("div",{children:"Error"})]})]})]})]})},$t=g((()=>{var e=Object(r.useState)(!1),t=Object(v.a)(e,2),a=t[0],c=t[1];return a?Object(n.jsx)(kt,{setIsLogin:c}):Object(n.jsx)(qt,{setIsLogin:c})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Lt=a(263),Wt=a.n(Lt),Ft=new f.InMemoryCache,At=Wt()({uri:"http://162.243.169.189/graphql/",headers:{authorization:localStorage.getItem("authToken")?"JWT ".concat(localStorage.getItem("authToken")):""}}),Bt=new f.ApolloClient({link:At,cache:Ft});Ft.writeQuery({query:ie,data:{isLoggedIn:!!localStorage.getItem("authToken")}});var Rt=e=>Object(f.useQuery)(ie).data.isLoggedIn?Object(n.jsx)(Ot,{}):e.children;s.a.render(Object(n.jsx)(f.ApolloProvider,{client:Bt,children:Object(n.jsx)(Rt,{children:Object(n.jsx)($t,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}))}},[[198,1,2]]]);
//# sourceMappingURL=main.d4db50e5.chunk.js.map