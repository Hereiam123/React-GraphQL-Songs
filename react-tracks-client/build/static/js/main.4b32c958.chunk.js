(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{198:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n.n(r),i=n(18),s=n.n(i),o=n(86),l=n(151),u=n(233),j=n(104),d=n.n(j),b=n(105),p=n.n(b),O=n(234),m=Object(l.a)({palette:{primary:{light:d.a[500],main:d.a[700],dark:d.a[900]},secondary:{light:p.a[200],main:p.a[500],dark:p.a[700]}},typography:{useNextVariants:!0}}),g=function(e){return function(t){return Object(a.jsxs)(u.a,{theme:m,children:[Object(a.jsx)(O.a,{}),Object(a.jsx)(e,Object(o.a)({},t))]})}},h=n(63),x=n(21),f=n(11),v=n(10),k=n(242),y=n(22),w=n(31),S=n.n(w),N=n(49),I=n(154),C=n(200),T=n(264),q=n(96),$=n.n(q),L=n(141),W=n.n(L);function F(){var e=Object(y.a)(["\n  query($search: String) {\n    tracks(search: $search) {\n      id\n      title\n      description\n      url\n      likes {\n        id\n      }\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"]);return F=function(){return e},e}var A=Object(f.gql)(F()),B=Object(k.a)((function(e){return{root:{padding:"2px 4px",margin:e.spacing.unit,display:"flex",alignItems:"center"}}})),R=function(e){var t=e.setSearchResults,n=B(),c=Object(r.useRef)(null),i=Object(r.useState)(""),s=Object(v.a)(i,2),o=s[0],l=s[1],u=function(){var e=Object(N.a)(S.a.mark((function e(n,a){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,a.query({query:A,variables:{search:o}});case 3:r=e.sent,t(r.data.tracks);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){t([]),l(""),c.current.focus()};return Object(a.jsx)(f.ApolloConsumer,{children:function(e){return Object(a.jsx)("form",{onSubmit:function(t){return u(t,e)},children:Object(a.jsxs)(I.a,{className:n.root,elevation:1,children:[Object(a.jsx)(C.a,{onClick:j,children:Object(a.jsx)($.a,{})}),Object(a.jsx)(T.a,{fullWidth:!0,placeholder:"Search All Tracks",InputProps:{disableUnderline:!0},onChange:function(e){return l(e.target.value)},value:o,inputRef:c}),Object(a.jsx)(C.a,{type:"submit",children:Object(a.jsx)(W.a,{})})]})})}})},D=n(240),U=n(268),z=n(249),Q=n(250),P=n(251),E=n(252),M=n(51),J=n(253),G=n(145),V=n.n(G),H=n(142),K=n.n(H),X=function(e){var t=e.url;return Object(a.jsx)("div",{children:Object(a.jsx)(K.a,{url:t,height:"30px",width:"500px",controls:!0})})},Y=n(101),Z=n.n(Y),_=n(266),ee=n(243),te=Object(k.a)((function(e){return{snackbar:{margin:e.spacing.unit}}})),ne=function(e){var t=e.error,n=Object(r.useState)(!0),c=Object(v.a)(n,2),i=c[0],s=c[1],o=te();return Object(a.jsx)(_.a,{open:i,className:o.snackbar,action:Object(a.jsx)(ee.a,{onClick:function(){s(!1)},color:"secondary",size:"small",children:"Close"}),message:t})};function ae(){var e=Object(y.a)(["\n  {\n    me {\n      id\n      username\n      email\n      likeSet {\n        track {\n          id\n        }\n      }\n    }\n  }\n"]);return ae=function(){return e},e}function re(){var e=Object(y.a)(["\n  query getTracksQuery {\n    tracks {\n      id\n      title\n      description\n      url\n      likes {\n        id\n      }\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"]);return re=function(){return e},e}function ce(){var e=Object(y.a)(["\n  query IsUserLoggedIn {\n    isLoggedIn @client\n  }\n"]);return ce=function(){return e},e}var ie=Object(f.gql)(ce()),se=Object(f.gql)(re()),oe=Object(f.gql)(ae());function le(){var e=Object(y.a)(["\n  mutation($trackId: Int!) {\n    createLike(trackId: $trackId) {\n      track {\n        id\n        likes {\n          id\n        }\n      }\n    }\n  }\n"]);return le=function(){return e},e}var ue=Object(f.gql)(le()),je=Object(k.a)((function(e){return{iconButton:{color:"deeppink"},icon:{marginLeft:e.spacing.unit/2}}})),de=function(e){var t=e.trackId,n=e.likeCount,c=je(),i=Object(r.useContext)(mt),s=Object(f.useMutation)(ue,{refetchQueries:[{query:oe}]}),o=Object(v.a)(s,2),l=o[0],u=o[1].error;if(u)return Object(a.jsx)(ne,{error:u});return Object(a.jsxs)(C.a,{onClick:function(e){e.stopPropagation(),l({variables:{trackId:t}})},className:c.iconButton,disabled:i.likeSet.findIndex((function(e){return e.track.id===t}))>-1,children:[n,Object(a.jsx)(Z.a,{className:c.icon})]})},be=n(48),pe=n(244),Oe=n(143),me=n.n(Oe);function ge(){var e=Object(y.a)(["\n  mutation($trackId: Int!) {\n    deleteTrack(trackId: $trackId) {\n      trackId\n    }\n  }\n"]);return ge=function(){return e},e}var he=Object(f.gql)(ge()),xe=function(e){var t=e.track,n=Object(r.useContext)(mt),c=Object(r.useState)(!1),i=Object(v.a)(c,2),s=i[0],o=i[1],l=Object(f.useMutation)(he,{update:function(e,t){b(e,t)},onCompleted:function(){p()}}),u=Object(v.a)(l,2),j=u[0],d=u[1].error,b=function(e,t){var n=t.data.deleteTrack,a=e.readQuery({query:se}),r=a.tracks.findIndex((function(e){return Number(e.id)===n.trackId})),c=[].concat(Object(be.a)(a.tracks.slice(0,r)),Object(be.a)(a.tracks.slice(r+1)));e.writeQuery({query:se,data:{tracks:c}})},p=function(){o(!1)},O=n.id===t.postedBy.id;return d?Object(a.jsx)(ne,{error:"Delete Track Error"}):O&&Object(a.jsx)(C.a,{onClick:function(){o(!0),j({variables:{trackId:t.id}})},children:s?Object(a.jsx)(pe.a,{size:24}):Object(a.jsx)(me.a,{})})},fe=n(267),ve=n(245),ke=n(246),ye=n(247),we=n(238),Se=n(241),Ne=n(248),Ie=n(144),Ce=n.n(Ie),Te=n(102),qe=n.n(Te);function $e(){var e=Object(y.a)(["\n  mutation(\n    $trackId: Int!\n    $title: String!\n    $description: String!\n    $file: Upload!\n  ) {\n    updateTrack(\n      trackId: $trackId\n      title: $title\n      description: $description\n      file: $file\n    ) {\n      track {\n        id\n        title\n        description\n        url\n        likes {\n          id\n        }\n        postedBy {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return $e=function(){return e},e}var Le=Object(f.gql)($e()),We=Object(k.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},dialog:{margin:"0 auto",maxWidth:550},textField:{margin:e.spacing.unit},cancel:{color:"red"},save:{color:"green"},button:{margin:2*e.spacing.unit},icon:{marginLeft:e.spacing.unit},input:{display:"none"}}})),Fe=function(e){var t=e.track,n=We(),c=Object(r.useContext)(mt),i=Object(f.useMutation)(Le,{onCompleted:function(){Q()}}),s=Object(v.a)(i,2),o=s[0],l=s[1].error,u=Object(r.useState)(!1),j=Object(v.a)(u,2),d=j[0],b=j[1],p=Object(r.useState)(t.title),O=Object(v.a)(p,2),m=O[0],g=O[1],h=Object(r.useState)(t.description),x=Object(v.a)(h,2),k=x[0],y=x[1],w=Object(r.useState)(""),I=Object(v.a)(w,2),q=I[0],$=I[1],L=Object(r.useState)(!1),W=Object(v.a)(L,2),F=W[0],A=W[1],B=Object(r.useState)(""),R=Object(v.a)(B,2),D=R[0],U=R[1],z=c.id===t.postedBy.id,Q=function(){b(!1),A(!1),g(""),y(""),$("")},P=function(){var e=Object(N.a)(S.a.mark((function e(n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),A(!0),o({variables:{title:m,description:k,file:q,trackId:t.id}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return l?Object(a.jsx)(ne,{error:"Update Track Error"}):z&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(C.a,{onClick:function(){b(!0)},children:Object(a.jsx)(Ce.a,{})}),Object(a.jsx)(fe.a,{open:d,className:n.dialog,children:Object(a.jsxs)("form",{onSubmit:function(e){P(e)},children:[Object(a.jsx)(ve.a,{children:"Update Track"}),Object(a.jsx)(ke.a,{children:Object(a.jsxs)(ye.a,{component:"span",children:["Update Title, Description or Audio File",Object(a.jsx)(we.a,{fullWidth:!0,children:Object(a.jsx)(T.a,{label:"Title",placeholder:"Add Title",className:n.textField,onChange:function(e){g(e.target.value)},value:m})}),Object(a.jsx)(we.a,{fullWidth:!0,children:Object(a.jsx)(T.a,{multiline:!0,row:"2",label:"Description",placeholder:"Add Description",className:n.textField,onChange:function(e){y(e.target.value)},value:k})}),Object(a.jsxs)(we.a,{fullWidth:!0,error:""!==D,children:[Object(a.jsx)("input",{id:"audio",required:!0,type:"file",className:n.input,accept:"audio/mp3,audio/wav",onChange:function(e){var t=e.target.files[0];t&&t.size>1e7?U("".concat(t.name,": File size too large, 10mb max.")):($(t),U(""))}}),Object(a.jsxs)("label",{htmlFor:"audio",children:[Object(a.jsxs)(ee.a,{variant:"outlined",color:q?"secondary":"inherit",component:"span",className:n.button,children:["Audio File",Object(a.jsx)(qe.a,{className:n.icon})]}),q&&q.name]}),Object(a.jsx)(Se.a,{children:D})]})]})}),Object(a.jsxs)(Ne.a,{children:[Object(a.jsx)(ee.a,{onClick:function(){b(!1)},className:n.cancel,disabled:F,children:"Cancel"}),Object(a.jsx)(ee.a,{disabled:F||!m.trim()||!k.trim()||!q,type:"submit",className:n.save,children:F?Object(a.jsx)(pe.a,{size:24,className:n.save}):"Update Track"})]})]})})]})},Ae=Object(k.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},details:{alignItems:"center"},link:{color:"#424242",textDecoration:"none","&:hover":{color:"black"}}}})),Be=function(e){var t=e.tracks,n=Ae();return Object(a.jsx)(D.a,{children:t.map((function(e){return Object(a.jsxs)(U.a,{children:[Object(a.jsx)(z.a,{expandIcon:Object(a.jsx)(V.a,{}),children:Object(a.jsxs)(Q.a,{className:n.root,children:[Object(a.jsx)(de,{trackId:e.id,likeCount:e.likes.length}),Object(a.jsx)(P.a,{primaryTypographyProps:{variant:"h4",color:"primary"},primary:e.title,secondary:Object(a.jsx)(h.b,{to:"/profile/".concat(e.postedBy.id),className:n.link,children:e.postedBy.username})}),Object(a.jsx)(X,{url:e.url})]})}),Object(a.jsx)(E.a,{className:n.details,children:Object(a.jsx)(M.a,{variant:"body1",children:e.description})}),Object(a.jsxs)(J.a,{children:[Object(a.jsx)(Fe,{track:e}),Object(a.jsx)(xe,{track:e})]})]},e.id)}))})},Re=n(146),De=n.n(Re);function Ue(){var e=Object(y.a)(["\n  mutation($title: String!, $description: String!, $file: Upload!) {\n    createTrack(title: $title, description: $description, file: $file) {\n      track {\n        id\n        title\n        description\n        url\n        likes {\n          id\n        }\n        postedBy {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return Ue=function(){return e},e}var ze=Object(f.gql)(Ue()),Qe=Object(k.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},dialog:{margin:"0 auto",maxWidth:550},textField:{margin:e.spacing.unit},cancel:{color:"red"},save:{color:"green"},button:{margin:2*e.spacing.unit},icon:{marginLeft:e.spacing.unit},input:{display:"none"},fab:{position:"fixed",bottom:2*e.spacing.unit,right:2*e.spacing.unit,zIndex:"200"}}})),Pe=function(){var e=Qe(),t=Object(f.useMutation)(ze,{update:function(e,t){A(e,t)},onCompleted:function(){B()}}),n=Object(v.a)(t,2),c=n[0],i=n[1].error,s=Object(r.useState)(!1),o=Object(v.a)(s,2),l=o[0],u=o[1],j=Object(r.useState)(""),d=Object(v.a)(j,2),b=d[0],p=d[1],O=Object(r.useState)(""),m=Object(v.a)(O,2),g=m[0],h=m[1],x=Object(r.useState)(""),k=Object(v.a)(x,2),y=k[0],w=k[1],S=Object(r.useState)(!1),N=Object(v.a)(S,2),I=N[0],C=N[1],q=Object(r.useState)(""),L=Object(v.a)(q,2),W=L[0],F=L[1],A=function(e,t){var n=t.data.createTrack,a=e.readQuery({query:se}).tracks.concat(n.track);e.writeQuery({query:se,data:{tracks:a}})},B=function(){u(!1),C(!1),p(""),h(""),w("")};return i?Object(a.jsx)(ne,{error:"Create Track Error"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ee.a,{onClick:function(){u(!0)},variant:"outlined",className:e.fab,color:"secondary",children:l?Object(a.jsx)($.a,{}):Object(a.jsx)(De.a,{})}),Object(a.jsx)(fe.a,{open:l,className:e.dialog,children:Object(a.jsxs)("form",{onSubmit:function(e){!function(e){e.preventDefault(),C(!0),c({variables:{title:b,description:g,file:y}})}(e)},children:[Object(a.jsx)(ve.a,{children:"Create Track"}),Object(a.jsx)(ke.a,{children:Object(a.jsxs)(ye.a,{component:"span",children:["Add a Title, Description and Audio File",Object(a.jsx)(we.a,{fullWidth:!0,children:Object(a.jsx)(T.a,{label:"Title",placeholder:"Add Title",className:e.textField,onChange:function(e){p(e.target.value)},value:b})}),Object(a.jsx)(we.a,{fullWidth:!0,children:Object(a.jsx)(T.a,{multiline:!0,row:"2",label:"Description",placeholder:"Add Description",className:e.textField,onChange:function(e){h(e.target.value)},value:g})}),Object(a.jsxs)(we.a,{fullWidth:!0,error:""!==W,children:[Object(a.jsx)("input",{id:"audio",required:!0,type:"file",className:e.input,accept:"audio/mp3,audio/wav",onChange:function(e){var t=e.target.files[0];t&&t.size>1e7?F("".concat(t.name,": File size too large, 10mb max.")):(w(t),F(""))}}),Object(a.jsxs)("label",{htmlFor:"audio",children:[Object(a.jsxs)(ee.a,{variant:"outlined",color:y?"secondary":"inherit",component:"span",className:e.button,children:["Audio File",Object(a.jsx)(qe.a,{className:e.icon})]}),y&&y.name]}),Object(a.jsx)(Se.a,{children:W})]})]})}),Object(a.jsxs)(Ne.a,{children:[Object(a.jsx)(ee.a,{onClick:function(){u(!1)},className:e.cancel,disabled:I,children:"Cancel"}),Object(a.jsx)(ee.a,{disabled:I||!b.trim()||!g.trim()||!y,type:"submit",className:e.save,children:I?Object(a.jsx)(pe.a,{size:24,className:e.save}):"Add Track"})]})]})})]})},Ee=Object(k.a)((function(e){return{root:{width:"100vw",textAlign:"center"},progress:{margin:2*e.spacing.unit,color:e.palette.secondary.dark}}})),Me=function(){var e=Ee();return Object(a.jsx)("div",{className:e.root,children:Object(a.jsx)(pe.a,{className:e.progress})})},Je=Object(k.a)((function(e){return{container:{margin:"0 auto",maxWidth:960,padding:2*e.spacing.unit}}})),Ge=function(){var e=Je(),t=Object(r.useState)([]),n=Object(v.a)(t,2),c=n[0],i=n[1],s=Object(r.useState)([]),o=Object(v.a)(s,2),l=o[0],u=o[1],j=Object(f.useQuery)(se),d=j.loading,b=j.error,p=j.data;return Object(r.useEffect)((function(){c.length>0?u(c):p&&u(p.tracks)}),[c,p]),d?Object(a.jsx)(Me,{}):b?Object(a.jsx)(ne,{error:b}):Object(a.jsxs)("div",{className:e.container,children:[Object(a.jsx)(R,{setSearchResults:i}),Object(a.jsx)(Pe,{}),Object(a.jsx)(Be,{tracks:l})]})},Ve=n(15),He=n(254),Ke=n(255),Xe=n(270),Ye=n(256),Ze=n(147),_e=n.n(Ze);function et(){var e=Object(y.a)(["\n  query($id: Int!) {\n    user(id: $id) {\n      id\n      username\n      dateJoined\n      trackSet {\n        id\n        title\n        url\n        likes {\n          id\n        }\n      }\n      likeSet {\n        id\n        track {\n          id\n          title\n          url\n          likes {\n            id\n          }\n          postedBy {\n            id\n            username\n          }\n        }\n      }\n    }\n  }\n"]);return et=function(){return e},e}var tt=Object(f.gql)(et()),nt=Object(k.a)((function(e){return{paper:Object(Ve.a)({width:"auto",display:"block",padding:2*e.spacing.unit,marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},e.breakpoints.up("md"),{width:650,marginLeft:"auto",marginRight:"auto"}),card:{display:"flex",justifyContent:"center"},title:{display:"flex",alignItems:"center",marginBottom:2*e.spacing.unit},audioIcon:{color:"purple",fontSize:30,marginRight:e.spacing.unit},thumbIcon:{color:"green",marginRight:e.spacing.unit},divider:{marginTop:e.spacing.unit,marginBottom:e.spacing.unit}}})),at=function(e){var t=e.match,n=nt(),r=Object(f.useQuery)(tt,{variables:{id:t.params.id}}),c=r.loading,i=r.error,s=r.data;return c?Object(a.jsx)(Me,{}):i?Object(a.jsx)(ne,{error:i}):Object(a.jsxs)("div",{children:[Object(a.jsx)(He.a,{className:n.card,children:Object(a.jsx)(Ke.a,{avatar:Object(a.jsx)(Xe.a,{children:s.user.username[0]}),title:s.user.username,subheader:"Joined ".concat(new Date(s.user.dateJoined).toISOString().substring(0,10))})}),Object(a.jsxs)(I.a,{elevation:1,className:n.paper,children:[Object(a.jsxs)(M.a,{variant:"subtitle1",className:n.title,children:[Object(a.jsx)(_e.a,{className:n.audioIcon}),"Created Tracks"]}),s.user.trackSet.map((function(e){return Object(a.jsxs)("div",{children:[Object(a.jsxs)(M.a,{children:[e.title," - ",e.likes.length," Likes"]}),Object(a.jsx)(X,{url:e.url}),Object(a.jsx)(Ye.a,{className:n.divider})]},e.id)}))]}),Object(a.jsxs)(I.a,{elevation:1,className:n.paper,children:[Object(a.jsxs)(M.a,{variant:"subtitle1",className:n.title,children:[Object(a.jsx)(Z.a,{className:n.thumbIcon}),"Liked Tracks"]}),s.user.likeSet.map((function(e){var t=e.track;return Object(a.jsxs)("div",{children:[Object(a.jsxs)(M.a,{children:[t.title," - ",t.likes.length," Likes -"," ",t.postedBy.username]}),Object(a.jsx)(X,{url:t.url}),Object(a.jsx)(Ye.a,{className:n.divider})]},t.id)}))]})]})},rt=n(257),ct=n(258),it=n(149),st=n.n(it),ot=n(150),lt=n.n(ot),ut=n(148),jt=n.n(ut),dt=Object(k.a)((function(e){return{root:{cursor:"pointer",display:"flex"},buttonIcon:{marginLeft:"5px"}}})),bt=function(){var e=dt(),t=function(){var e=Object(N.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("authToken"),t.writeQuery({query:ie,data:{isLoggedIn:!1}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)(f.ApolloConsumer,{children:function(n){return Object(a.jsxs)(ee.a,{onClick:function(){t(n)},children:[Object(a.jsx)(M.a,{variant:"body1",className:e.buttonIcon,color:"secondary",children:"Signout"}),Object(a.jsx)(jt.a,{className:e.buttonIcon,color:"secondary"})]})}})},pt=Object(k.a)((function(e){return{root:{flexGrow:1,margin:0,padding:0},grow:{flexGrow:1,display:"flex",alignItems:"center",textDecoration:"none"},logo:{marginRight:e.spacing.unit,fontSize:45},faceIcon:{marginRight:e.spacing.unit,fontSize:30,color:"white"},username:{color:"white",fontSize:30}}})),Ot=function(e){var t=e.currentUser,n=pt();return Object(a.jsx)(rt.a,{position:"static",className:n.root,children:Object(a.jsxs)(ct.a,{children:[Object(a.jsxs)(h.b,{to:"/",className:n.grow,children:[Object(a.jsx)(st.a,{className:n.logo,color:"secondary"}),Object(a.jsx)(M.a,{variant:"h3",color:"secondary",noWrap:!0,children:"Musicallen"})]}),t&&Object(a.jsxs)(h.b,{to:"/profile/".concat(t.id),className:n.grow,children:[Object(a.jsx)(lt.a,{className:n.faceIcon}),Object(a.jsx)(M.a,{variant:"h3",className:n.username,noWrap:!0,children:t.username})]}),Object(a.jsx)(bt,{})]})})},mt=c.a.createContext(),gt=g((function(){var e=Object(f.useQuery)(oe,{fetchPolicy:"cache-and-network"}),t=e.loading,n=e.error,r=e.data;return t?Object(a.jsx)(Me,{}):n?Object(a.jsx)(ne,{error:n}):Object(a.jsx)(h.a,{children:Object(a.jsxs)(mt.Provider,{value:r.me,children:[Object(a.jsx)(Ot,{currentUser:r.me}),Object(a.jsxs)(x.c,{children:[Object(a.jsx)(x.a,{path:"/",exact:!0,component:Ge}),Object(a.jsx)(x.a,{path:"/profile/:id",component:at})]})]})})})),ht=n(269),xt=n(237),ft=n(259);function vt(){var e=Object(y.a)(["\n  mutation($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return vt=function(){return e},e}var kt=Object(f.gql)(vt()),yt=Object(k.a)((function(e){return{root:Object(Ve.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up("md"),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit},title:{marginTop:2*e.spacing.unit,color:e.palette.secondary.main},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.primary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit}}})),wt=function(e){var t=e.setIsLogin,n=Object(r.useState)(""),c=Object(v.a)(n,2),i=c[0],s=c[1],o=Object(r.useState)(""),l=Object(v.a)(o,2),u=l[0],j=l[1],d=yt(),b=Object(f.useMutation)(kt),p=Object(v.a)(b,2),O=p[0],m=p[1],g=m.loading,h=m.error,x=m.client,k=function(){var e=Object(N.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O({variables:{password:u,username:i}});case 4:n=e.sent,localStorage.setItem("authToken",n.data.tokenAuth.token),x.writeQuery({query:ie,data:{isLoggedIn:!0}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)("div",{className:d.root,children:Object(a.jsxs)(I.a,{className:d.paper,children:[Object(a.jsx)(Xe.a,{className:d.avatar,children:Object(a.jsx)(ft.a,{})}),Object(a.jsx)(M.a,{variant:"h4",children:"Login as Existing User"}),Object(a.jsxs)("form",{className:d.form,onSubmit:function(e){k(e)},children:[Object(a.jsxs)(we.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(a.jsx)(ht.a,{htmlFor:"username",children:"Username"}),Object(a.jsx)(xt.a,{id:"username",onChange:function(e){s(e.target.value)}})]}),Object(a.jsxs)(we.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(a.jsx)(ht.a,{htmlFor:"password",children:"Password"}),Object(a.jsx)(xt.a,{id:"password",type:"password",onChange:function(e){j(e.target.value)}})]}),Object(a.jsx)(ee.a,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",disabled:g||!i.trim()||!u.trim(),className:d.submit,children:g?"Logging in...":"Login"}),Object(a.jsx)(ee.a,{onClick:function(){t(!1)},color:"primary",variant:"outlined",fullWidth:!0,children:"New user? Register here."}),g&&Object(a.jsx)("p",{children:"Loading..."}),h&&Object(a.jsx)(ne,{error:h.toString()})]})]})})},St=n(260),Nt=n(261),It=n(262);function Ct(){var e=Object(y.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    createUser(username: $username, email: $email, password: $password) {\n      user {\n        username\n        email\n      }\n    }\n  }\n"]);return Ct=function(){return e},e}var Tt=c.a.forwardRef((function(e,t){return Object(a.jsx)(St.a,Object(o.a)({direction:"up",ref:t},e))})),qt=Object(f.gql)(Ct()),$t=Object(k.a)((function(e){return{root:Object(Ve.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up("md"),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit},title:{marginTop:2*e.spacing.unit,color:e.palette.openTitle},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},icon:{padding:"0px 2px 2px 0px",verticalAlign:"middle",color:"green"}}})),Lt=function(e){var t=e.setIsLogin,n=Object(r.useState)(""),c=Object(v.a)(n,2),i=c[0],s=c[1],o=Object(r.useState)(""),l=Object(v.a)(o,2),u=l[0],j=l[1],d=Object(r.useState)(""),b=Object(v.a)(d,2),p=b[0],O=b[1],m=Object(r.useState)(!1),g=Object(v.a)(m,2),h=g[0],x=g[1],k=$t(),y=Object(f.useMutation)(qt),w=Object(v.a)(y,2),C=w[0],T=w[1],q=T.loading,$=T.error,L=function(){var e=Object(N.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,C({variables:{email:u,password:p,username:i}});case 4:x(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:k.root,children:[Object(a.jsxs)(I.a,{className:k.paper,children:[Object(a.jsx)(Xe.a,{className:k.avatar,children:Object(a.jsx)(Nt.a,{})}),Object(a.jsx)(M.a,{variant:"h4",children:"Register"}),Object(a.jsxs)("form",{className:k.form,onSubmit:function(e){L(e)},children:[Object(a.jsxs)(we.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(a.jsx)(ht.a,{htmlFor:"username",children:"Username"}),Object(a.jsx)(xt.a,{id:"username",onChange:function(e){s(e.target.value)}})]}),Object(a.jsxs)(we.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(a.jsx)(ht.a,{htmlFor:"email",children:"Email"}),Object(a.jsx)(xt.a,{id:"email",type:"email",onChange:function(e){j(e.target.value)}})]}),Object(a.jsxs)(we.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(a.jsx)(ht.a,{htmlFor:"password",children:"Password"}),Object(a.jsx)(xt.a,{id:"password",type:"password",onChange:function(e){O(e.target.value)}})]}),Object(a.jsx)(ee.a,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",disabled:q||!i.trim()||!u.trim()||!p.trim(),className:k.submit,children:q?"Registering...":"Register"}),Object(a.jsx)(ee.a,{onClick:function(){t(!0)},color:"primary",variant:"outlined",fullWidth:!0,children:"Previous user? Login in here."}),q&&Object(a.jsx)("p",{children:"Loading..."}),$&&Object(a.jsx)(ne,{error:$.toString()})]})]}),Object(a.jsxs)(fe.a,{disableBackdropClick:!0,open:h,TransitionComponent:Tt,children:[Object(a.jsxs)(ve.a,{children:[Object(a.jsx)(It.a,{className:k.icon}),"New Account"]}),Object(a.jsxs)(ke.a,{children:[Object(a.jsxs)(ye.a,{children:["User ",i," successfully created!"]}),Object(a.jsxs)(Ne.a,{children:[Object(a.jsx)(ee.a,{color:"primary",variant:"contained",onClick:function(){t(!0)},children:"Login"}),$&&Object(a.jsx)("div",{children:"Error"})]})]})]})]})},Wt=g((function(){var e=Object(r.useState)(!1),t=Object(v.a)(e,2),n=t[0],c=t[1];return n?Object(a.jsx)(wt,{setIsLogin:c}):Object(a.jsx)(Lt,{setIsLogin:c})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ft=n(263),At=n.n(Ft),Bt=new f.InMemoryCache,Rt=At()({uri:"https://www.reactsongs.com/graphql/",headers:{authorization:localStorage.getItem("authToken")?"JWT ".concat(localStorage.getItem("authToken")):""}}),Dt=new f.ApolloClient({link:Rt,cache:Bt});Bt.writeQuery({query:ie,data:{isLoggedIn:!!localStorage.getItem("authToken")}});var Ut=function(e){return Object(f.useQuery)(ie).data.isLoggedIn?Object(a.jsx)(gt,{}):e.children};s.a.render(Object(a.jsx)(f.ApolloProvider,{client:Dt,children:Object(a.jsx)(Ut,{children:Object(a.jsx)(Wt,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[198,1,2]]]);
//# sourceMappingURL=main.4b32c958.chunk.js.map